import{d as H,e as J,f as X,g as Y,h as Q,i as Z,j as q,k as ee,l as te,m as ne,n as re,o as ie,p as ae,q as oe,r as se}from"./chunk-FXZEBWRS.js";import{a as S,b as T,c as y,d as x,e as f,f as E}from"./chunk-G2YJTG3K.js";import{a as z,d as k,i as $,j as W}from"./chunk-UV36F6Q7.js";import{$a as K,Ba as P,C as _,Ca as N,D as m,Da as U,Fa as L,O as a,W as C,Y as o,Ya as D,Za as B,_a as F,a as R,b,cb as j,f as w,fa as h,g as v,ga as d,ha as I,ia as c,ja as l,la as g,n as G,na as u,oa as s,w as M,x as V,xa as A,ya as O}from"./chunk-FGHEDK35.js";function le(t,n){if(t&1){let e=g();c(0),h(1,"app-course-item",11),u("openModal",function(){let i=_(e).index,p=s(2);return m(p.openModal(i))}),d(),l()}if(t&2){let e=n.$implicit;a(),o("data",e)}}function pe(t,n){if(t&1&&(c(0),C(1,le,2,1,"ng-container",10),l()),t&2){let e=s();a(),o("ngForOf",e.results)}}function _e(t,n){if(t&1){let e=g();c(0),h(1,"app-article-item",11),u("openModal",function(){let i=_(e).index,p=s(2);return m(p.openModal(i))}),d(),l()}if(t&2){let e=n.$implicit;a(),o("data",e)}}function me(t,n){if(t&1&&(c(0),C(1,_e,2,1,"ng-container",10),l()),t&2){let e=s();a(),o("ngForOf",e.results)}}function he(t,n){if(t&1){let e=g();c(0),h(1,"app-projects-item",11),u("openModal",function(){let i=_(e).index,p=s(2);return m(p.openModal(i))}),d(),l()}if(t&2){let e=n.$implicit;a(),o("data",e)}}function de(t,n){if(t&1&&(c(0),C(1,he,2,1,"ng-container",10),l()),t&2){let e=s();a(),o("ngForOf",e.results)}}function ue(t,n){if(t&1){let e=g();c(0),h(1,"app-financing-item",11),u("openModal",function(){let i=_(e).index,p=s(2);return m(p.openModal(i))}),d(),l()}if(t&2){let e=n.$implicit;a(),o("data",e)}}function ge(t,n){if(t&1&&(c(0),C(1,ue,2,1,"ng-container",10),l()),t&2){let e=s();a(),o("ngForOf",e.results)}}function Ce(t,n){if(t&1){let e=g();c(0),h(1,"app-supplier-item",11),u("openModal",function(){let i=_(e).index,p=s(2);return m(p.openModal(i))}),d(),l()}if(t&2){let e=n.$implicit;a(),o("data",e)}}function Se(t,n){if(t&1&&(c(0),C(1,Ce,2,1,"ng-container",10),l()),t&2){let e=s();a(),o("ngForOf",e.results)}}function Te(t,n){if(t&1){let e=g();c(0),h(1,"app-startup-item",11),u("openModal",function(){let i=_(e).index,p=s(2);return m(p.openModal(i))}),d(),l()}if(t&2){let e=n.$implicit;a(),o("data",e)}}function ye(t,n){if(t&1&&(c(0),C(1,Te,2,1,"ng-container",10),l()),t&2){let e=s();a(),o("ngForOf",e.results)}}function xe(t,n){if(t&1){let e=g();c(0),h(1,"app-course-modal",12),u("close",function(){_(e);let i=s(2);return m(i.closeModal())})("next",function(){_(e);let i=s(2);return m(i.showNextItem())}),d(),l()}if(t&2){let e=s(2);a(),o("data",e.dataModal)}}function fe(t,n){if(t&1){let e=g();c(0),h(1,"app-article-modal",12),u("close",function(){_(e);let i=s(2);return m(i.closeModal())})("next",function(){_(e);let i=s(2);return m(i.showNextItem())}),d(),l()}if(t&2){let e=s(2);a(),o("data",e.dataModal)}}function Ee(t,n){if(t&1){let e=g();c(0),h(1,"app-projects-modal",12),u("close",function(){_(e);let i=s(2);return m(i.closeModal())})("next",function(){_(e);let i=s(2);return m(i.showNextItem())}),d(),l()}if(t&2){let e=s(2);a(),o("data",e.dataModal)}}function Me(t,n){if(t&1){let e=g();c(0),h(1,"app-financing-modal",12),u("close",function(){_(e);let i=s(2);return m(i.closeModal())})("next",function(){_(e);let i=s(2);return m(i.showNextItem())}),d(),l()}if(t&2){let e=s(2);a(),o("data",e.dataModal)}}function we(t,n){if(t&1){let e=g();c(0),h(1,"app-supplier-modal",12),u("close",function(){_(e);let i=s(2);return m(i.closeModal())})("next",function(){_(e);let i=s(2);return m(i.showNextItem())}),d(),l()}if(t&2){let e=s(2);a(),o("data",e.dataModal)}}function Ie(t,n){if(t&1){let e=g();c(0),h(1,"app-startup-modal",12),u("close",function(){_(e);let i=s(2);return m(i.closeModal())})("next",function(){_(e);let i=s(2);return m(i.showNextItem())}),d(),l()}if(t&2){let e=s(2);a(),o("data",e.dataModal)}}function Re(t,n){if(t&1&&(c(0),C(1,xe,2,1,"ng-container",8)(2,fe,2,1,"ng-container",8)(3,Ee,2,1,"ng-container",8)(4,Me,2,1,"ng-container",8)(5,we,2,1,"ng-container",8)(6,Ie,2,1,"ng-container",8),l()),t&2){let e=s();a(),o("ngSwitchCase",e.ResourceType.COURSE),a(),o("ngSwitchCase",e.ResourceType.ARTICLE),a(),o("ngSwitchCase",e.ResourceType.PROJECT),a(),o("ngSwitchCase",e.ResourceType.FINNANCING),a(),o("ngSwitchCase",e.ResourceType.SUPPLIER),a(),o("ngSwitchCase",e.ResourceType.STARTUP)}}var ce=class t{recursosService=M(z);modeloMadurezService=M(W);modeloCaracterService=M($);modeloMadurez=this.modeloMadurezService.modeloMadurez;modeloCaracter=this.modeloCaracterService.modeloCaracter;ResourceType=k;isModalOpen=!1;dataModal;currentData=[];currentIndex=0;tipIndex=0;charIndex=0;typingSpeed=50;tipDelay=3e3;typingTimeout;isUserTyping=!1;searchSubject=new v;searchTip="";searchMessage="";searchInput="";resultCount="";isLoading=!1;results=[];suggested=[];key={suppliers:"s\xED",curses:"2024",articles:"",projects:"",financing:"",startups:""};tips=[];customMessages=[];searchKeywords=[];breadcrumbs=[];resourceType="curses";labelType="Cursos";resourceOptions=[{type:"curses",label:"Cursos"},{type:"articles",label:"Art\xEDculos"},{type:"projects",label:"Proyectos"},{type:"financing",label:"Financiamiento"},{type:"suppliers",label:"Proveedores"},{type:"startups",label:"Startups"}];ngOnInit(){this.initializeTexts(),this.typeTip(),this.searchSubject.pipe(G(300)).subscribe(n=>{this.handleSearch(n)})}setResourceType(n){this.resourceType=n,this.initializeTexts(),this.clearSearch()}initializeTexts(){switch(this.resourceType){case"curses":this.labelType=S.LABEL,this.tips=S.TIPS,this.customMessages=S.CUSTOM_MESSAGES,this.searchKeywords=S.SEARCH_KEYWORDS,this.breadcrumbs=S.BREADCRUMBS;break;case"articles":this.labelType=T.LABEL,this.tips=T.TIPS,this.customMessages=T.CUSTOM_MESSAGES,this.searchKeywords=T.SEARCH_KEYWORDS,this.breadcrumbs=T.BREADCRUMBS;break;case"projects":this.labelType=y.LABEL,this.tips=y.TIPS,this.customMessages=y.CUSTOM_MESSAGES,this.searchKeywords=y.SEARCH_KEYWORDS,this.breadcrumbs=y.BREADCRUMBS;break;case"financing":this.labelType=f.LABEL,this.tips=f.TIPS,this.customMessages=f.CUSTOM_MESSAGES,this.searchKeywords=f.SEARCH_KEYWORDS,this.breadcrumbs=f.BREADCRUMBS;break;case"suppliers":this.labelType=x.LABEL,this.tips=x.TIPS,this.customMessages=x.CUSTOM_MESSAGES,this.searchKeywords=x.SEARCH_KEYWORDS,this.breadcrumbs=x.BREADCRUMBS;break;case"startups":this.labelType=E.LABEL,this.tips=E.TIPS,this.customMessages=E.CUSTOM_MESSAGES,this.searchKeywords=E.SEARCH_KEYWORDS,this.breadcrumbs=E.BREADCRUMBS;break}}typeTip(){if(!this.tips)return;this.tipIndex>=this.tips?.length&&(this.tipIndex=0);let n=this.tips[this.tipIndex];this.charIndex<n.length?(this.searchTip+=n.charAt(this.charIndex),this.charIndex++,this.typingTimeout=setTimeout(()=>this.typeTip(),this.typingSpeed)):this.typingTimeout=setTimeout(()=>{this.searchTip="",this.charIndex=0,this.tipIndex++,this.typeTip()},this.tipDelay)}onSearchInputChange(){this.searchSubject.next(this.searchInput.trim().toLowerCase())}handleSearch(n){n.length>=2?(this.isUserTyping||(this.isUserTyping=!0,this.showSearchMessage()),this.fetchResults(n)):(this.results=[],this.resultCount="",this.isUserTyping&&(this.isUserTyping=!1,this.hideSearchMessage(),this.searchTip="",clearTimeout(this.typingTimeout),this.typeTip()))}fetchResults(n){return w(this,null,function*(){if(n.length<2){this.results=[],this.resultCount="";return}try{this.isLoading=!0;let e=yield this.recursosService.fetchResults(n,this.resourceType);this.displayResults(e,n)}catch(e){console.warn("Error al obtener los datos:",e),this.results=[],this.resultCount="Error al obtener los datos."}finally{this.isLoading=!1,this.fetchSuggested()}})}fetchSuggested(){return w(this,null,function*(){if(this.resourceType!=="curses"&&this.resourceType!=="suppliers"||!this.modeloCaracter()&&!this.modeloMadurez())return;let n=this.key[this.resourceType];this.modeloMadurez()&&this.modeloMadurez()?.[0]?.IndustryName&&(n=this.modeloMadurez()?.[0]?.IndustryName??this.key[this.resourceType]),this.recursosService.searchResources(n,this.resourceType,3).subscribe({next:e=>{this.suggested=e.map(r=>b(R({},r),{recomendado:!0})),console.warn(this.suggested),this.results=[...this.suggested,...this.results]},error:e=>{console.error("Error al obtener los datos:",e),console.warn("Error al obtener los datos:",e),this.suggested=[]}})})}displayResults(n,e){this.currentData=n,this.results=this.currentData,this.resultCount=`${this.currentData.length} resultado${this.currentData.length!==1?"s":""} para "${e}"`,this.currentData.length===0&&(this.resultCount="No se encontraron resultados.")}openModal(n){this.currentIndex=n;let e=this.results[this.currentIndex];this.isModalOpen=!0,this.dataModal=e}closeModal(){this.isModalOpen=!1,this.dataModal=void 0}showNextItem(){this.currentData.length!==0&&(this.currentIndex=(this.currentIndex+1)%this.currentData.length,this.openModal(this.currentIndex))}showSearchMessage(){let n=this.customMessages[Math.floor(Math.random()*this.customMessages.length)];this.searchMessage=n}hideSearchMessage(){this.searchMessage=""}addSuggestedTerm(n){let e=this.searchInput.trim(),r=e.length>0?" ":"";this.searchInput=`${e}${r}${n}`,this.onSearchInputChange()}clearSearch(){this.searchInput="",this.results=[],this.resultCount="",this.hideSearchMessage(),this.searchTip="",clearTimeout(this.typingTimeout),this.typeTip()}handleKeyPress(n,e){(n.key==="Enter"||n.key===" ")&&this.addSuggestedTerm(e)}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=V({type:t,selectors:[["app-general-search"]],standalone:!0,features:[L],decls:19,vars:19,consts:[[1,"bg-[#fff]","text-[rgb(31,41,55)]","min-h-screen"],[3,"breadcrumbs"],[1,"container","mx-auto","py-12","flex","flex-col","lg:flex-row"],[1,"w-full","lg:w-3/4","px-8"],[1,"text-3xl","font-bold","mb-6"],[3,"searchInputChange","resourceTypeChange","clearSearch","addSuggestedTerm","triggerSearch","searchTip","searchMessage","searchInput","searchKeywords","resultCount","isLoading","resourceOptions","selectedResourceType"],[1,"space-y-8"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngIf"],[4,"ngFor","ngForOf"],[1,"p-4",3,"openModal","data"],[3,"close","next","data"]],template:function(e,r){e&1&&(h(0,"div",0),I(1,"app-breadcrumbs",1),h(2,"main",2)(3,"div",3)(4,"h1",4),A(5),d(),h(6,"app-search-controls",5),U("searchInputChange",function(p){return N(r.searchInput,p)||(r.searchInput=p),p}),u("resourceTypeChange",function(p){return r.setResourceType(p)})("searchInputChange",function(){return r.onSearchInputChange()})("clearSearch",function(){return r.clearSearch()})("addSuggestedTerm",function(p){return r.addSuggestedTerm(p)})("triggerSearch",function(){return r.onSearchInputChange()}),d(),h(7,"div",6),c(8,7),C(9,pe,2,1,"ng-container",8)(10,me,2,1,"ng-container",8)(11,de,2,1,"ng-container",8)(12,ge,2,1,"ng-container",8)(13,Se,2,1,"ng-container",8)(14,ye,2,1,"ng-container",8),l(),d()(),h(15,"aside"),I(16,"app-sugeridos"),d()(),c(17,7),C(18,Re,7,6,"ng-container",9),l(),d()),e&2&&(a(),o("breadcrumbs",r.breadcrumbs),a(4),O(r.labelType),a(),o("searchTip",r.searchTip)("searchMessage",r.searchMessage),P("searchInput",r.searchInput),o("searchKeywords",r.searchKeywords)("resultCount",r.resultCount)("isLoading",r.isLoading)("resourceOptions",r.resourceOptions)("selectedResourceType",r.resourceType),a(2),o("ngSwitch",r.resourceType),a(),o("ngSwitchCase",r.ResourceType.COURSE),a(),o("ngSwitchCase",r.ResourceType.ARTICLE),a(),o("ngSwitchCase",r.ResourceType.PROJECT),a(),o("ngSwitchCase",r.ResourceType.FINNANCING),a(),o("ngSwitchCase",r.ResourceType.SUPPLIER),a(),o("ngSwitchCase",r.ResourceType.STARTUP),a(3),o("ngSwitch",r.resourceType),a(),o("ngIf",r.isModalOpen&&r.dataModal))},dependencies:[J,X,H,j,D,B,F,K,Q,Y,q,Z,re,ne,te,ee,ae,ie,se,oe]})};export{ce as GeneralSearchComponent};
